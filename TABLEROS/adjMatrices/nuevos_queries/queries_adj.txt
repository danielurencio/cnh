/*CREATE TABLE t_1 AS*/
SELECT A.ID_LICITANTE_ADJ, A.ID_BLOQUE, B.AREA, A.INV_USD
FROM DATOS_LICITACIONES_BLOQUES1 A
LEFT JOIN DATOS_LICITACIONES_BLOQUES B
ON A.ID_BLOQUE = B.ID_BLOQUE
WHERE A.ID_LICITANTE_ADJ is not null;

/*CREATE TABLE T_2 AS*/
SELECT ID_LICITANTE_ADJ, COUNT(ID_BLOQUE) AS ADJUDICADOS, SUM(AREA) AS AREA, SUM(INV_USD) AS INV_USD
FROM T_1
GROUP BY ID_LICITANTE_ADJ;

/*CREATE TABLE T_3 AS*/
SELECT A.*, B.*
FROM T_2 A
LEFT JOIN DATOS_LICITACIONES_LIC_MAT B
ON B.ID_LICITANTE = A.ID_LICITANTE_ADJ;

/*CREATE TABLE T_4 AS*/
SELECT A.MATRIZ,B.*
FROM T_3 B
LEFT JOIN DATOS_LICITACIONES_MATRICES A
ON B.ID_MATRIZ=A.ID_MATRIZ;
