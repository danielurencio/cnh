$(document).ready(function() {
	setTimeout(function() {
		$('#btnAtencionCiudadana').click(function() {
			var url = 'https://www.gob.mx/atencion/?description=' + $('#descripcion').val() + '&site=cnh';
			window.location.href = url;
		});
	}, 500);

    setGADownloadsEvents();
});

var debugMode = false;
var lang = function() {
    if(getCookieValue('lng') === '') {
        try {
            return window.location.search.match(/(\?|&)lng\=([^&]*)/)[2];
        } catch(e) {
            return 'es_MX';
        }
    } else {
        return getCookieValue('lng');
    }
}

if(!debugMode) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-86485159-1', 'auto');
	ga('send', 'pageview');
}

function setGADownloadsEvents() {
    var docs = document.getElementsByClassName('ga-downloads');
    for(var i = 0; i < docs.length; i++) {
        docs[i].removeEventListener('click', gaDownloadListenersHandler);
        docs[i].addEventListener('click', gaDownloadListenersHandler);
    }
}

function gaDownloadListenersHandler(btn) {
    gaReportEvent(btn.toElement);
}

function gaReportEvent(doc) {
    !doc.getAttribute('data-name') ? doc = doc.parentNode : doc = doc;
    var name = doc.getAttribute('data-name');

    if(!debugMode) {
        ga('send', 'event', 'Documents', 'Download', name);
    } else {
        console.log('send event to GA: Documents, Download,', name);
    }
}

function getCookieValue(cname) {
    // This function return the value from a cookie
    var name = cname + '=';
    var ca = document.cookie.split(';');
    for(var i = 0; i <ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ') {
            c = c.substring(1);
        }

        if (c.indexOf(name) == 0) {
            return c.substring(name.length,c.length);
        }
    }

    return '';
}

function saveCookie(cname, cvalue, cexpire, cpath) {
    // This function allow to save a cookies || cname[string], cvalue[string], cexpire[bool], cpath[bool]
    var saveCookie = cname + '=' + cvalue;

    if(cexpire != false) {
        var expires = function() {
            var now = new Date();
            return new Date(now.setFullYear(now.getFullYear() - 1));
        }
        saveCookie += '; expires=' + expires().toString().split(' (')[0];
    }

    if(cpath != false) {
        saveCookie += '; path=' + cpath;
    }

    document.cookie = saveCookie;
}

function deleteCookie(cname) {
	// Delete a cookie from browser and session
	 var expires = function() {
        var now = new Date();
        return new Date(now.setFullYear(now.getFullYear() - 1));
    }

	document.cookie = cname + '=""; expires=' + expires().toString().split(' (')[0];
}

function readGetParameter(parameter) {
    var parameters = window.location.search.substr(1);
    parameters = parameters.split('&');
    for(var i = 0; i < parameters.length; i++) {
        var tmp = parameters[i].split('=');
        if(tmp[0] === parameter) {
            return tmp[1];
        }
    }

    return '';
}

function randomString(length, chars) {
    var mask = '';

    if(chars.indexOf('a') > -1) {
		mask += 'abcdefghijklmnopqrstuvwxyz'
	};

    if(chars.indexOf('A') > -1) {
		mask += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
	}

    if(chars.indexOf('#') > -1) {
		mask += '0123456789';
	}

    if(chars.indexOf('!') > -1) {
		mask += '!@#$^*+-{}[]\?';
	}

    var result = '';

    for(var i = length; i > 0; --i) {
		result += mask[Math.floor(Math.random() * mask.length)];
	}

    return result;
}